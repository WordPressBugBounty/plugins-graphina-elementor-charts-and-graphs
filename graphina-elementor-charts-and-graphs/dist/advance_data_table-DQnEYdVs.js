class v{constructor(){this.extraData={},this.init(),this.currentPage=1,this.rowsPerPage=10,this.pageRange=2,this.observer={}}init(){this.bindEventHandlers()}bindEventHandlers(){jQuery(window).on("elementor/frontend/init",this.handleElementorWidgetInit.bind(this)),jQuery(window).on("elementor/editor/init",this.handleElementorWidgetInit.bind(this))}handleElementorWidgetInit(){elementorFrontend.hooks.addAction("frontend/element_ready/widget",e=>{const t=e.find(".graphina-advance-data-table");t.length>0&&this.initializeTables(t)})}initializeTables(e){this.observeTableElement(e,"advance-datatable")}observeTableElement(e,t){const a=e.data("element_id");gcfe_public_localize.view_port==="off"?(this.observer[a]||(this.observer[a]=new IntersectionObserver(s=>{s.forEach(o=>{o.isIntersecting&&(this.setupTable(jQuery(o.target),t),this.observer[a].unobserve(o.target))})},{threshold:.1})),this.observer[a].observe(e[0])):this.setupTable(e,t)}getJson(e){let t=[],a=[],s=document.querySelector(e+" table"),o=s.getElementsByTagName("th");o.length>0&&Object.keys(o).forEach((r,n)=>{let c=o[n].getElementsByTagName("input")[0].value;t.push(c)});let i=s.getElementsByTagName("tr");return i.length>0&&Object.keys(i).forEach((r,n)=>{let c=[],p=i[n].getElementsByTagName("td");p.length>0&&(Object.keys(p).forEach((E,u)=>{let b=p[u].getElementsByTagName("input")[0].value;c.push(b)}),a.push(c))}),JSON.stringify({header:t,body:a})}generateTable(e,t,a=!1){var b,x;const s=document.querySelector(`.graphina-table-${t}`);s&&(s.innerHTML="");const o=jQuery("body").hasClass("elementor-editor-active"),i=document.createElement("table");i.classList.add("graphina-table-base","table-bordered","table-padding-left",`datatable-${t}`);let l=this.extraData.columns||e.header.length,r=this.extraData.rows||e.body.length;this.extraData.header_in_body&&r++,this.extraData.is_index&&!o&&l++,a&&(r=e.body.length);const n=(this.currentPage-1)*this.rowsPerPage,c=n+this.rowsPerPage;let p=[];this.extraData.is_pagination&&(this.extraData.is_dynamic_table||!o)?(p=e.body.slice(n,c),r=p.length):p=e.body;const m=document.createElement("thead");m.classList.add("graphina-table-header");const E=document.createElement("tr");if(this.extraData.is_header&&e.header.length>0){for(let d=0;d<l;d++){const h=document.createElement("th");if(h.classList.add("graphina-table-cell"),o&&!this.extraData.is_dynamic_table){const g=document.createElement("input");g.type="text",g.setAttribute("placeholder",`Header ${d+1}`),g.value=e.header[d]||`Column ${d+1}`,h.append(g)}else h.innerHTML=e.header[d]||`Column ${d+1}`;E.appendChild(h)}m.appendChild(E),i.appendChild(m)}const u=document.createElement("tbody");if(u.classList.add("graphina-table-body"),r!==0&&e.header.length>0)for(let d=0;d<r;d++){const h=document.createElement("tr");for(let g=0;g<l;g++){const f=document.createElement("td");if(f.classList.add("graphina-table-cell"),o&&!this.extraData.is_dynamic_table){const y=document.createElement("input");y.type="text",y.setAttribute("placeholder",`Value ${g+1}`),y.value=((b=p[d])==null?void 0:b[g])||"",f.append(y)}else f.innerHTML=((x=p[d])==null?void 0:x[g])||"";h.appendChild(f)}u.appendChild(h)}else{const d=document.createElement("tr"),h=document.createElement("td");h.setAttribute("colspan",e.header.length),h.classList.add("graphina-table-no-data"),h.classList.add("graphina-table-cell"),h.innerText=gcfe_public_localize.no_data_available,d.appendChild(h),u.appendChild(d)}i.appendChild(u),s.append(i),this.extraData.is_pagination&&(this.extraData.is_dynamic_table||!o)&&(this.extraData.pagination_type==="numbers"?this.generatePaginationControlsNumber(e,t):this.extraData.pagination_type==="simple"?this.generatePaginationControlsSimple(e,t):this.extraData.pagination_type==="simple_numbers"?this.generatePaginationControlsSimpleNumbers(e,t):this.generatePaginationControlsFistLast(e,t))}createButton(e,t,a=!1){const s=document.createElement("span");return s.classList.add("pagination-link","graphina-align"),a?s.innerHTML=`<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 320 512" width="${e}" height="${e}" fill="${t}"><path d="M9.4 233.4c-12.5 12.5-12.5 32.8 0 45.3l192 192c12.5 12.5 32.8 12.5 45.3 0s12.5-32.8 0-45.3L77.3 256 246.6 86.6c12.5-12.5 12.5-32.8 0-45.3s-32.8-12.5-45.3 0l-192 192z"/></svg>`:s.innerHTML=`<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 320 512" width="${e}" height="${e}" fill="${t}"><path d="M278.6 233.4c12.5 12.5 12.5 32.8 0 45.3l-160 160c-12.5 12.5-32.8 12.5-45.3 0s-12.5-32.8 0-45.3L210.7 256 73.4 118.6c-12.5-12.5-12.5-32.8 0-45.3s32.8-12.5 45.3 0l160 160z"/></svg>`,s}createPaginationInfo(e,t){if(this.extraData.pagination_info){const a=document.createElement("div");a.classList.add("pagination-info");const s=(this.currentPage-1)*this.rowsPerPage+1,o=Math.min(t,this.currentPage*this.rowsPerPage);a.innerText=`Showing ${s} to ${o} of ${t} entries`,e.append(a),this.paginationStyle(e,a)}}generatePaginationControlsFistLast(e,t){const a=document.querySelector(`.graphina-table-${t}`);let s=Math.ceil(e.body.length/this.rowsPerPage);const o=document.createElement("section");o.classList.add("pagination-section");const i=document.createElement("div");i.classList.add("pagination");let l=e.body.length;if(this.createPaginationInfo(i,l),s>1){const r=document.createElement("div");if(r.classList.add("page-links-wrapper"),r.style.display="flex",this.currentPage>1){const n=this.createButton(this.extraData.pagination_button_height,this.extraData.pagination_text_color,!0);n.addEventListener("click",()=>{this.currentPage--,this.generateTable(e,t)}),r.appendChild(n)}for(let n=1;n<=s;n++)if(n===1||s===n){const c=document.createElement("button");c.textContent=n,c.classList.add("pagination-link"),n===this.currentPage&&c.classList.add("active"),c.addEventListener("click",()=>{this.currentPage=n,this.generateTable(e,t)}),r.appendChild(c)}if(this.currentPage<s){const n=this.createButton(this.extraData.pagination_button_height,this.extraData.pagination_text_color,!1);n.addEventListener("click",()=>{this.currentPage++,this.generateTable(e,t)}),r.appendChild(n)}i.appendChild(r)}o.appendChild(i),a.appendChild(o)}generatePaginationControlsSimpleNumbers(e,t){const a=document.querySelector(`.graphina-table-${t}`);let s=Math.ceil(e.body.length/this.rowsPerPage),o=e.body.length;const i=document.createElement("section");i.classList.add("pagination-section");const l=document.createElement("div");if(l.classList.add("pagination"),this.createPaginationInfo(l,o),s>1){const r=document.createElement("div");if(r.classList.add("page-links-wrapper"),r.style.display="flex",this.currentPage>1){const n=this.createButton(this.extraData.pagination_button_height,this.extraData.pagination_text_color,!0);n.addEventListener("click",()=>{this.currentPage--,this.generateTable(e,t)}),r.appendChild(n)}for(let n=Math.max(1,this.currentPage-this.pageRange);n<=Math.min(s,this.currentPage+this.pageRange);n++){const c=document.createElement("button");c.textContent=n,c.classList.add("pagination-link"),n===this.currentPage&&c.classList.add("active"),c.addEventListener("click",()=>{this.currentPage=n,this.generateTable(e,t)}),r.appendChild(c)}if(this.currentPage<s){const n=this.createButton(this.extraData.pagination_button_height,this.extraData.pagination_text_color,!1);n.addEventListener("click",()=>{this.currentPage++,this.generateTable(e,t)}),r.appendChild(n)}l.appendChild(r)}i.appendChild(l),a.appendChild(i)}paginationStyle(e,t){const a=this.extraData.pagination_align;a==="right"?e.classList.add("rightLeft"):a==="left"?e.classList.add("leftRight"):a==="center"&&(e.classList.add("centerPagination"),this.extraData.pagination_info==="yes"&&(t.style.margin="20px 0"))}generatePaginationControlsSimple(e,t){const a=document.querySelector(`.graphina-table-${t}`);let s=Math.ceil(e.body.length/this.rowsPerPage);const o=document.createElement("section");o.classList.add("pagination-section");const i=document.createElement("div");i.classList.add("pagination");let l=e.body.length;if(this.createPaginationInfo(i,l),s>1){const r=document.createElement("div");r.classList.add("page-links-wrapper"),r.style.display="flex";const n=this.createButton(this.extraData.pagination_button_height,this.extraData.pagination_text_color,!0);n.disabled=this.currentPage===1,n.addEventListener("click",()=>{this.currentPage>1&&(this.currentPage--,this.generateTable(e,t))}),r.appendChild(n);const c=this.createButton(this.extraData.pagination_button_height,this.extraData.pagination_text_color,!1);c.disabled=this.currentPage===s,c.addEventListener("click",()=>{this.currentPage<s&&(this.currentPage++,this.generateTable(e,t))}),r.appendChild(c),i.appendChild(r)}o.appendChild(i),a.appendChild(o)}generatePaginationControlsNumber(e,t){const a=document.querySelector(`.graphina-table-${t}`);let s=Math.ceil(e.body.length/this.rowsPerPage);const o=document.createElement("section");o.classList.add("pagination-section");const i=document.createElement("div");i.classList.add("pagination");let l=e.body.length;if(this.createPaginationInfo(i,l),s>1){for(let r=Math.max(1,this.currentPage-this.pageRange);r<=Math.min(s,this.currentPage+this.pageRange);r++){const n=document.createElement("button");n.textContent=r,n.classList.add("pagination-link"),r===this.currentPage&&n.classList.add("active"),n.addEventListener("click",()=>{this.currentPage=r,this.generateTable(e,t)}),i.appendChild(n)}o.appendChild(i),a.appendChild(o)}}getDynamicData(e,t){let a=jQuery(`[data-element_id="${e}"]`).closest("[data-elementor-id]").data("elementor-id");return new Promise((s,o)=>{jQuery.ajax({url:gcfe_public_localize.ajaxurl,type:"POST",dataType:"json",data:{action:"get_jquery_datatable_data",nonce:gcfe_public_localize.table_nonce,chartType:"advance-datatable",post_id:a,element_id:e,series_count:0,settings:JSON.stringify(t),selected_field:[]},success:i=>{s(i)},error:i=>{console.error("AJAX Error:",i),o(new Error("AJAX request failed."))}})})}async setupTable(e,t){const a=e.data("element_id");this.extraData=e.data("extra_data");const s=e.data("table_data"),o=e.data("settings");if(this.rowsPerPage=this.extraData.pagination_row,this.pageRange=this.extraData.page_range,this.extraData.is_dynamic_table){const i=await this.getDynamicData(a,o);this.generateTable(i.data,a),this.setupSearchFilter(a,i.data)}else this.generateTable(s,a);this.extraData.is_dynamic_table||(document.querySelector(`.graphina-table-${a} table`)&&document.querySelector(`.graphina-table-${a} table`).addEventListener("change",()=>{let i=this.getJson(`.graphina-table-${a}`),l=parent.document.querySelector(`input[data-setting="${this.extraData.prefix}advance-datatable_element_data_json"]`);if(document.querySelector(`input[data-setting="${this.extraData.prefix}advance-datatable_element_data_json"]`),l){l.value=i;let r=new Event("input",{bubbles:!0});l.dispatchEvent(r)}else console.warn("Hidden input field not found!")}),this.setupSearchFilter(a,s))}setupSearchFilter(e,t){const a=document.getElementById(`table-filter-${e}`);a&&a.addEventListener("keyup",()=>{const s=a.value.toLowerCase(),o=t.body;let i={header:t.header,body:[]};i.body=o.filter(function(l){return l.filter(function(r){return r.toString().toLowerCase().includes(s)}).length>0}),this.generateTable(i,e,!0)})}}new v;
//# sourceMappingURL=advance_data_table-DQnEYdVs.js.map
