class v{constructor(){this.extraData={},this.init(),this.currentPage=1,this.rowsPerPage=10,this.pageRange=2}init(){this.bindEventHandlers()}bindEventHandlers(){jQuery(window).on("elementor/frontend/init",this.handleElementorWidgetInit.bind(this)),jQuery(window).on("elementor/editor/init",this.handleElementorWidgetInit.bind(this))}handleElementorWidgetInit(){elementorFrontend.hooks.addAction("frontend/element_ready/widget",e=>{const t=e.find(".graphina-advance-data-table");t.length>0&&this.initializeTables(t)})}initializeTables(e){this.observeTableElement(e,"advance-datatable")}observeTableElement(e,t){gcfe_public_localize.view_port==="off"?(this.observer||(this.observer=new IntersectionObserver(n=>{n.forEach(i=>{i.isIntersecting&&(this.setupTable(jQuery(i.target),t),this.observer.unobserve(i.target))})},{threshold:.1})),this.observer.observe(e[0])):this.setupTable(e,t)}getJson(e){let t=[],n=[],i=document.querySelector(e+" table"),o=i.getElementsByTagName("th");o.length>0&&Object.keys(o).forEach((s,a)=>{let c=o[a].getElementsByTagName("input")[0].value;t.push(c)});let r=i.getElementsByTagName("tr");return r.length>0&&Object.keys(r).forEach((s,a)=>{let c=[],p=r[a].getElementsByTagName("td");p.length>0&&(Object.keys(p).forEach((E,u)=>{let b=p[u].getElementsByTagName("input")[0].value;c.push(b)}),n.push(c))}),JSON.stringify({header:t,body:n})}generateTable(e,t,n=!1){var b,x;const i=document.querySelector(`.graphina-table-${t}`);i&&(i.innerHTML="");const o=jQuery("body").hasClass("elementor-editor-active"),r=document.createElement("table");r.classList.add("graphina-table-base","table-bordered","table-padding-left",`datatable-${t}`);let l=this.extraData.columns||e.header.length,s=this.extraData.rows||e.body.length;this.extraData.header_in_body&&s++,this.extraData.is_index&&!o&&l++,n&&(s=e.body.length);const a=(this.currentPage-1)*this.rowsPerPage,c=a+this.rowsPerPage;let p=[];this.extraData.is_pagination&&(this.extraData.is_dynamic_table||!o)?(p=e.body.slice(a,c),s=p.length):p=e.body;const m=document.createElement("thead");m.classList.add("graphina-table-header");const E=document.createElement("tr");if(this.extraData.is_header&&e.header.length>0){for(let d=0;d<l;d++){const h=document.createElement("th");if(h.classList.add("graphina-table-cell"),o&&!this.extraData.is_dynamic_table){const g=document.createElement("input");g.type="text",g.setAttribute("placeholder",`Header ${d+1}`),g.value=e.header[d]||`Column ${d+1}`,h.append(g)}else h.textContent=e.header[d]||`Column ${d+1}`;E.appendChild(h)}m.appendChild(E),r.appendChild(m)}const u=document.createElement("tbody");if(u.classList.add("graphina-table-body"),s!==0&&e.header.length>0)for(let d=0;d<s;d++){const h=document.createElement("tr");for(let g=0;g<l;g++){const f=document.createElement("td");if(f.classList.add("graphina-table-cell"),o&&!this.extraData.is_dynamic_table){const y=document.createElement("input");y.type="text",y.setAttribute("placeholder",`Value ${g+1}`),y.value=((b=p[d])==null?void 0:b[g])||"",f.append(y)}else f.textContent=((x=p[d])==null?void 0:x[g])||"";h.appendChild(f)}u.appendChild(h)}else{const d=document.createElement("tr"),h=document.createElement("td");h.setAttribute("colspan",e.header.length),h.classList.add("graphina-table-no-data"),h.classList.add("graphina-table-cell"),h.innerText=gcfe_public_localize.no_data_available,d.appendChild(h),u.appendChild(d)}r.appendChild(u),i.append(r),this.extraData.is_pagination&&(this.extraData.is_dynamic_table||!o)&&(this.extraData.pagination_type==="numbers"?this.generatePaginationControlsNumber(e,t):this.extraData.pagination_type==="simple"?this.generatePaginationControlsSimple(e,t):this.extraData.pagination_type==="simple_numbers"?this.generatePaginationControlsSimpleNumbers(e,t):this.generatePaginationControlsFistLast(e,t))}createButton(e,t,n=!1){const i=document.createElement("span");return i.classList.add("pagination-link","graphina-align"),n?i.innerHTML=`<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 320 512" width="${e}" height="${e}" fill="${t}"><path d="M9.4 233.4c-12.5 12.5-12.5 32.8 0 45.3l192 192c12.5 12.5 32.8 12.5 45.3 0s12.5-32.8 0-45.3L77.3 256 246.6 86.6c12.5-12.5 12.5-32.8 0-45.3s-32.8-12.5-45.3 0l-192 192z"/></svg>`:i.innerHTML=`<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 320 512" width="${e}" height="${e}" fill="${t}"><path d="M278.6 233.4c12.5 12.5 12.5 32.8 0 45.3l-160 160c-12.5 12.5-32.8 12.5-45.3 0s-12.5-32.8 0-45.3L210.7 256 73.4 118.6c-12.5-12.5-12.5-32.8 0-45.3s32.8-12.5 45.3 0l160 160z"/></svg>`,i}createPaginationInfo(e,t){if(this.extraData.pagination_info){const n=document.createElement("div");n.classList.add("pagination-info");const i=(this.currentPage-1)*this.rowsPerPage+1,o=Math.min(t,this.currentPage*this.rowsPerPage);n.innerText=`Showing ${i} to ${o} of ${t} entries`,e.append(n),this.paginationStyle(e,n)}}generatePaginationControlsFistLast(e,t){const n=document.querySelector(`.graphina-table-${t}`);let i=Math.ceil(e.body.length/this.rowsPerPage);const o=document.createElement("section");o.classList.add("pagination-section");const r=document.createElement("div");r.classList.add("pagination");let l=e.body.length;if(this.createPaginationInfo(r,l),i>1){const s=document.createElement("div");if(s.classList.add("page-links-wrapper"),s.style.display="flex",this.currentPage>1){const a=this.createButton(this.extraData.pagination_button_height,this.extraData.pagination_text_color,!0);a.addEventListener("click",()=>{this.currentPage--,this.generateTable(e,t)}),s.appendChild(a)}for(let a=1;a<=i;a++)if(a===1||i===a){const c=document.createElement("button");c.textContent=a,c.classList.add("pagination-link"),a===this.currentPage&&c.classList.add("active"),c.addEventListener("click",()=>{this.currentPage=a,this.generateTable(e,t)}),s.appendChild(c)}if(this.currentPage<i){const a=this.createButton(this.extraData.pagination_button_height,this.extraData.pagination_text_color,!1);a.addEventListener("click",()=>{this.currentPage++,this.generateTable(e,t)}),s.appendChild(a)}r.appendChild(s)}o.appendChild(r),n.appendChild(o)}generatePaginationControlsSimpleNumbers(e,t){const n=document.querySelector(`.graphina-table-${t}`);let i=Math.ceil(e.body.length/this.rowsPerPage),o=e.body.length;const r=document.createElement("section");r.classList.add("pagination-section");const l=document.createElement("div");if(l.classList.add("pagination"),this.createPaginationInfo(l,o),i>1){const s=document.createElement("div");if(s.classList.add("page-links-wrapper"),s.style.display="flex",this.currentPage>1){const a=this.createButton(this.extraData.pagination_button_height,this.extraData.pagination_text_color,!0);a.addEventListener("click",()=>{this.currentPage--,this.generateTable(e,t)}),s.appendChild(a)}for(let a=Math.max(1,this.currentPage-this.pageRange);a<=Math.min(i,this.currentPage+this.pageRange);a++){const c=document.createElement("button");c.textContent=a,c.classList.add("pagination-link"),a===this.currentPage&&c.classList.add("active"),c.addEventListener("click",()=>{this.currentPage=a,this.generateTable(e,t)}),s.appendChild(c)}if(this.currentPage<i){const a=this.createButton(this.extraData.pagination_button_height,this.extraData.pagination_text_color,!1);a.addEventListener("click",()=>{this.currentPage++,this.generateTable(e,t)}),s.appendChild(a)}l.appendChild(s)}r.appendChild(l),n.appendChild(r)}paginationStyle(e,t){const n=this.extraData.pagination_align;n==="right"?e.classList.add("rightLeft"):n==="left"?e.classList.add("leftRight"):n==="center"&&(e.classList.add("centerPagination"),this.extraData.pagination_info==="yes"&&(t.style.margin="20px 0"))}generatePaginationControlsSimple(e,t){const n=document.querySelector(`.graphina-table-${t}`);let i=Math.ceil(e.body.length/this.rowsPerPage);const o=document.createElement("section");o.classList.add("pagination-section");const r=document.createElement("div");r.classList.add("pagination");let l=e.body.length;if(this.createPaginationInfo(r,l),i>1){const s=document.createElement("div");s.classList.add("page-links-wrapper"),s.style.display="flex";const a=this.createButton(this.extraData.pagination_button_height,this.extraData.pagination_text_color,!0);a.disabled=this.currentPage===1,a.addEventListener("click",()=>{this.currentPage>1&&(this.currentPage--,this.generateTable(e,t))}),s.appendChild(a);const c=this.createButton(this.extraData.pagination_button_height,this.extraData.pagination_text_color,!1);c.disabled=this.currentPage===i,c.addEventListener("click",()=>{this.currentPage<i&&(this.currentPage++,this.generateTable(e,t))}),s.appendChild(c),r.appendChild(s)}o.appendChild(r),n.appendChild(o)}generatePaginationControlsNumber(e,t){const n=document.querySelector(`.graphina-table-${t}`);let i=Math.ceil(e.body.length/this.rowsPerPage);const o=document.createElement("section");o.classList.add("pagination-section");const r=document.createElement("div");r.classList.add("pagination");let l=e.body.length;if(this.createPaginationInfo(r,l),i>1){for(let s=Math.max(1,this.currentPage-this.pageRange);s<=Math.min(i,this.currentPage+this.pageRange);s++){const a=document.createElement("button");a.textContent=s,a.classList.add("pagination-link"),s===this.currentPage&&a.classList.add("active"),a.addEventListener("click",()=>{this.currentPage=s,this.generateTable(e,t)}),r.appendChild(a)}o.appendChild(r),n.appendChild(o)}}getDynamicData(e,t){return new Promise((n,i)=>{jQuery.ajax({url:gcfe_public_localize.ajaxurl,type:"POST",dataType:"json",data:{action:"get_jquery_datatable_data",nonce:gcfe_public_localize.table_nonce,chartType:"advance-datatable",post_id:this.extraData.current_post_id,element_id:e,series_count:0,settings:t,selected_field:[]},success:o=>{n(o)},error:o=>{console.error("AJAX Error:",o),i(new Error("AJAX request failed."))}})})}async setupTable(e,t){const n=e.data("element_id");this.extraData=e.data("extra_data");const i=e.data("table_data"),o=e.data("settings");if(this.rowsPerPage=this.extraData.pagination_row,this.pageRange=this.extraData.page_range,this.extraData.is_dynamic_table){const r=await this.getDynamicData(n,o);this.generateTable(r.data,n),this.setupSearchFilter(n,r.data)}else this.generateTable(i,n);this.extraData.is_dynamic_table||(document.querySelector(`.graphina-table-${n} table`)&&document.querySelector(`.graphina-table-${n} table`).addEventListener("change",()=>{let r=this.getJson(`.graphina-table-${n}`),l=parent.document.querySelector(`input[data-setting="${this.extraData.prefix}advance-datatable_element_data_json"]`);if(document.querySelector(`input[data-setting="${this.extraData.prefix}advance-datatable_element_data_json"]`),l){l.value=r;let s=new Event("input",{bubbles:!0});l.dispatchEvent(s)}else console.warn("Hidden input field not found!")}),this.setupSearchFilter(n,i))}setupSearchFilter(e,t){const n=document.getElementById(`table-filter-${e}`);n&&n.addEventListener("keyup",()=>{const i=n.value.toLowerCase(),o=t.body;let r={header:t.header,body:[]};r.body=o.filter(function(l){return l.filter(function(s){return s.toString().toLowerCase().includes(i)}).length>0}),this.generateTable(r,e,!0)})}}new v;
//# sourceMappingURL=advance_data_table-BM2g7R56.js.map
