{"version":3,"file":"data_table-INl6G1IO.js","sources":["../assets/elementor/js/apex-chart/DataTable.js"],"sourcesContent":["// Class specifically for Data table\nexport default class DataTable {\n    constructor() {\n        this.tableHandlers = {};\n        this.tableId = '';\n        this.dataTable = {}\n        this.init();\n        this.observer = {}; // For IntersectionObserver\n    }\n\n    // Initialize the class by setting up handlers and events\n    init() {\n        this.setUpTableHandler();\n        this.bindEventHandlers();\n    }\n\n    // Bind event listeners\n    bindEventHandlers() {\n        jQuery(window).on('elementor/frontend/init', this.handleElementorWidgetInit.bind(this));\n        jQuery(window).on('load', () => {\n        jQuery('.graphina-jquery-data-table').each((i, el) => {\n            this.initializeTables(jQuery(el));\n        });\n        });\n        jQuery(document.body).off('click','.graphina-filter-div-button')\n        jQuery(document.body).on('click','.graphina-filter-div-button', this.debounce(this.handleChartFilterTable.bind(this), 300));\n \n    }\n\n    debounce(func, wait) {\n        let timeout;\n    \n        return function(...args) {\n            const context = this;\n            clearTimeout(timeout);\n            timeout = setTimeout(() => func.apply(context, args), wait);\n        };\n    }\n\n    handleChartFilterTable(e){\n            const currentElement = e.currentTarget\n            const elementId      = jQuery(currentElement).data('element_id');\n            const chartElement   = jQuery(`.graphina-jquery-data-table[data-element_id=\"${elementId}\"]`);\n            if(chartElement.length > 0){\n                this.setupTable(chartElement,[])\n            }    \n    }\n\n    handleElementorWidgetInit() {\n    elementorFrontend.hooks.addAction('frontend/element_ready/data_table_lite.default', ($scope) => {\n        console.log('Initializing jQuery Data Table...');\n        \n        const chartElement = $scope.find('.graphina-jquery-data-table');\n        if (chartElement.length > 0) {\n            this.initializeTables(chartElement);\n        }\n    });\n}\n\n\n    initializeTables(chartElement) {\n        const chartType = chartElement.data('chart_type');\n        if (this.tableHandlers[chartType]) {\n            this.tableHandlers[chartType](chartElement);\n        }\n    }\n\n\n\n    setUpTableHandler() {\n        this.tableHandlers = {\n            data_table_lite: (element) => this.observeTableElement(element, 'data_table_lite'),\n        };\n    }\n\n    // Setup IntersectionObserver to call setupTable when the element is in the viewport\n    observeTableElement(element, dataTableType) {\n        const elementID = element.data('element_id')\n        if (gcfe_public_localize.view_port === 'off') {\n            if (!this.observer[elementID]) {\n                this.observer[elementID] = new IntersectionObserver((entries) => {\n                    entries.forEach((entry) => {\n                        if (entry.isIntersecting) {\n                            // Element is in viewport; initialize the chart\n                            this.setupTable(jQuery(entry.target), dataTableType);\n                            // Stop observing the element after initializing the chart\n                            this.observer[elementID].unobserve(entry.target);\n                        }\n                    });\n                }, { threshold: 0.1 }); // Trigger when at least 10% of the element is visible\n            }\n            this.observer[elementID].observe(element[0]); // Start observing the chart element\n        } else {\n            this.setupTable(element, dataTableType);\n        }\n    }\n\n    getDynamicData(settings, extraData, elementId,filterValue) {\n        let post_id = jQuery(`[data-element_id=\"${elementId}\"]`).closest('[data-elementor-id]').data('elementor-id');\n        return new Promise((resolve, reject) => {\n            jQuery.ajax({\n                url: gcfe_public_localize.ajaxurl,\n                type: 'POST',\n                dataType: 'json',\n                data: {\n                    action      : 'get_jquery_datatable_data',\n                    nonce       : gcfe_public_localize.table_nonce,\n                    chartType   : 'data_table_lite',\n                    post_id     : post_id,\n                    element_id  : elementId,\n                    series_count: 0,\n                    settings    : JSON.stringify(settings),\n                    selected_field: filterValue,\n                },\n                success: (response) => {\n                    jQuery('#data_table_lite_loading_' + elementId).hide();\n                    jQuery('#data_table_lite_no_data_' + elementId).hide();\n                    resolve(response);\n                },\n                error: (error) => {\n                    jQuery('#data_table_lite_loading_' + elementId).hide();\n                    jQuery('#data_table_lite_no_data_' + elementId).hide();\n                    console.error('AJAX Error:', error);\n                    reject(new Error('AJAX request failed.'));\n                },\n            });\n        });\n    }\n\n    async setupTable(element, dataTableType) {\n        const element_id = element.data('element_id');\n        this.tableId     = element_id;\n\n        let chart_data      = element.data('chart_data');\n        const extraData     = element.data('extra_data');\n        const settings      = element.data('settings');\n        const tableSelector = '.data_table_lite_' + element_id;\n    \n        if ( extraData.hide_column_header ) {\n            chart_data.headerCallback = function(thead, data, start, end, display) {\n                jQuery(thead).hide();\n            }\n        }\n        chart_data.fnInitComplete = () => {\n            jQuery('.dataTables_scrollBody').css({\n                'overflow': 'hidden',\n                'border': '0'\n            });\n            jQuery(`#data_table_lite_${element_id} thead th`).addClass('all graphina-datatable-columns');\n            jQuery(`#data_table_lite_${element_id} tbody td`).addClass('graphina-datatable-tbody-td');\n    \n            const tableScrollFoot = jQuery('.dataTables_scrollFoot');\n            tableScrollFoot.css('overflow', 'auto');\n            tableScrollFoot.on('scroll', function () {\n                jQuery('.dataTables_scrollBody').scrollLeft(jQuery(this).scrollLeft());\n            });\n        };\n    \n        chart_data.rowCallback = function (row, data, index) {\n            if (index % 2 === 0) {\n                jQuery(row).addClass('odd');\n            } else {\n                jQuery(row).addClass('even');\n            }\n        };\n    \n        // Destroy existing DataTable and clear table HTML.\n        if (this.dataTable[element_id]) {\n            this.dataTable[element_id].clear().destroy();\n            jQuery(tableSelector).empty();\n        }\n    \n        // Handle dynamic data fetching if applicable.\n        if (extraData.is_dynamic_table) {\n            let filterValue   = [];\n            const totalFilter = jQuery(`#graphina_chart_filter_${element_id}`).data('total_filter');\n    \n            for (let index = 0; index < totalFilter; index++) {\n                filterValue[index] =\n                    jQuery(`#graphina-start-date_${index}${element_id}`).val() ??\n                    jQuery(`#graphina-drop_down_filter_${index}${element_id}`).val();\n            }\n    \n            const dynamicData = await this.getDynamicData(settings, extraData, element_id, filterValue);\n    \n            if (dynamicData.data.body.length !== 0 && dynamicData.data.header.length !== 0) {\n                chart_data.data = dynamicData.data.body;\n                chart_data.columns = dynamicData.data.header;\n                jQuery('#data_table_lite_loading_' + element_id).hide();\n            } else {\n                jQuery('#data_table_lite_loading_' + element_id).show();\n            }\n        } else {\n            if (chart_data.columns.length > 0) {\n                jQuery('#data_table_lite_loading_' + element_id).hide();\n            }\n        }\n    \n        // Add thead before reinitializing\n        if (chart_data.columns && chart_data.columns.length > 0) {\n            const theadHTML = '<thead><tr>' +\n                chart_data.columns.map(col => `<th>${col.title}</th>`).join('') +\n                '</tr></thead>';\n            jQuery(tableSelector).append(theadHTML);\n        }\n\n        // Initialize DataTable\n        this.dataTable[element_id] = jQuery(tableSelector).DataTable(chart_data);\n    \n        // Add tfoot if required\n        if (extraData.table_footer) {\n            jQuery(`#data_table_lite_${element_id}`).append('<tfoot><tr>' +\n                chart_data.columns.map(column => `<th class=\"${extraData.header_class}\">${column.title}</th>`).join('') +\n                '</tr></tfoot>');\n        }\n    \n        // Re-init if direct data table override is enabled\n        if (extraData.table_data_direct) {\n            this.dataTable[element_id].destroy();\n            jQuery(tableSelector).empty();\n    \n            const theadHTML = '<thead><tr>' +\n                chart_data.columns.map(col => `<th>${col.title}</th>`).join('') +\n                '</tr></thead>';\n            jQuery(tableSelector).append(theadHTML);\n    \n            this.dataTable[element_id] = jQuery(tableSelector).DataTable(chart_data);\n        }    \n    }\n    \n\n}\n// Initialize Data Table\nwindow.graphinaDataTable = new DataTable();\n"],"names":["DataTable","i","el","func","wait","timeout","args","context","currentElement","elementId","chartElement","$scope","chartType","element","dataTableType","elementID","entries","entry","settings","extraData","filterValue","post_id","resolve","reject","response","error","element_id","chart_data","tableSelector","thead","data","start","end","display","tableScrollFoot","row","index","totalFilter","dynamicData","theadHTML","col","column"],"mappings":"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"}